#!/usr/bin/env bash
echo "-----> Installing MuPDF 1.3"
cd $1
# download the binary (-O) silently (-s)
curl https://transfer.sh/kmsww/mupdf.tar.gz -O -s
mkdir -p vendor/mupdf
tar -C vendor/mupdf -xf mupdf.tar.gz
rm mupdf.tar.gz

echo "-----> Installing OPENCV"
curl https://transfer.sh/UOm2F/opencv.tar.gz -O
mkdir -p vendor/opencv
tar -C vendor/opencv -xf opencv.tar.gz
rm opencv.tar.gz

mkdir -p /app/.profile.d

PROFILE_PATH="$BUILD_DIR/.profile.d/opencv.sh"

cat << EOF > $PROFILE_PATH
  export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/app/vendor/opencv/lib
  export PYTHONPATH=$PYTHONPATH:/app/vendor/opencv/lib/python3.6/site-packages/
EOF
